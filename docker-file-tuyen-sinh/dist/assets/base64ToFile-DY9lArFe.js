import{r as b,j as a,u as C}from"./index-qv2f6qUe.js";import{a as g}from"./InputField-Bs1ecEZR.js";import{I as N}from"./formatTimestamp-CaO187jo.js";import{a as w}from"./DatetimePicker-OnKih5tk.js";const x=({name:e,id:n,value:i,setFileData:t,maxSize:s=0,disabled:r=!1,errors:c={},setErrors:y=void 0,label:l=""})=>{const f=b.useRef(null),o=d=>{var h;const u=(h=d.target.files)==null?void 0:h[0];u&&(u.size>s*1024*1024&&s>0&&alert("Kích thước ảnh vượt quá yêu cầu tối đa: "+String(s)+"MB"),t(m=>({...m,[e]:u})))},p=()=>{var d;(d=f.current)==null||d.click()};return a.jsxs("div",{className:"image-upload-container",children:[a.jsx("input",{name:e,id:n,type:"file",accept:"image/*",onChange:o,ref:f,style:{display:"none"},disabled:r}),l&&a.jsx("span",{className:"label",children:l}),a.jsx("div",{className:"image-preview",onClick:p,style:{backgroundImage:i?`url(${URL.createObjectURL(i)})`:"none",backgroundSize:"cover",backgroundPosition:"center"},children:!i&&a.jsxs("span",{children:["Nhấn để chọn ảnh ",s>0?`(Tối đa: ${s}MB)`:""]})}),a.jsxs("span",{className:`error-message ${c[e]?"":"not-active"}`,children:[".",c[e]]})]})},k=[{value:"0",label:"Nam"},{value:"1",label:"Nữ"}],T=({formData:e,setFormData:n,imgData:i,setImgData:t,errors:s,setErrors:r,isAdmin:c=!1,valids:y,status:l})=>{const f=b.useRef(null),{isLoading:o}=C(),[p,d]=b.useState("big");return b.useEffect(()=>{const u=f.current;if(!u)return;const h=new ResizeObserver(m=>{for(let j of m)j.contentRect.width<650?d("small"):d("big")});return h.observe(u),()=>h.disconnect()},[]),a.jsxs("form",{ref:f,className:"cccd-form",children:[a.jsxs("div",{className:`image-form ${p}`,children:[a.jsx(x,{name:"front",id:"front",value:Array.isArray(i.front)?i.front[0]:i.front,setFileData:t,disabled:c||l===1,errors:s,setErrors:r,label:"Mặt trước cccd"}),a.jsx(x,{name:"back",id:"back",value:Array.isArray(i.back)?i.back[0]:i.back,setFileData:t,disabled:c||l===1,errors:s,setErrors:r,label:"Mặt sau cccd"})]}),a.jsxs("div",{className:"text-form",children:[c&&a.jsx(g,{type:"text",name:"realName",id:"realName",placeholder:"Tên thật: ",value:e.realName,formData:e,setFormData:n,maxLength:12,errors:s,setErrors:r,isSubmiting:o,disabled:l===1}),a.jsx(g,{type:"text",name:"numCccd",id:"numCccd",placeholder:"Số căn cước công dân",value:e.numCccd,formData:e,setFormData:n,maxLength:12,errors:s,setErrors:r,isSubmiting:o,disabled:l===1}),a.jsx(w,{type:"date",name:"dateBirth",id:"dateBirth",value:String(e.dateBirth),setFormData:n,errors:s,setErrors:r,valids:y.dateBirth,disabled:l===1}),a.jsx(N,{type:"radio",name:"gender",id:"gender",label:"Giới tính",value:e.gender,choices:k,setFormData:n,columns:2,isSubmitting:o,disabled:l===1}),a.jsx(g,{type:"text",name:"address",id:"address",placeholder:"Địa chỉ",value:e.address,formData:e,setFormData:n,errors:s,setErrors:r,isSubmiting:o,disabled:l===1})]})]})},M=async e=>{const n={};for(const i in e){const t=e[i];t instanceof File?n[i]=await v(t):Array.isArray(t)?n[i]=await Promise.all(t.map(s=>v(s))):n[i]=void 0}return n};function v(e){return new Promise((n,i)=>{const t=new FileReader;t.onload=()=>n(t.result),t.onerror=i,t.readAsDataURL(e)})}const I=(e,n,i=new R({}),t={})=>i.required&&!(Array.isArray(n)?n.length>0:n instanceof File&&n.size>0)?{[e]:"Trường này là bắt buộc."}:{[e]:""};class R{constructor({required:n=!1}={}){this.required=n}validate(n,i){return I(n,i,this)}}function P(e,n,i){const t=atob(e.split(",")[1]||e),s=new ArrayBuffer(t.length),r=new Uint8Array(s);for(let c=0;c<t.length;c++)r[c]=t.charCodeAt(c);return new File([s],n,{type:i})}export{T as C,R as I,P as b,M as c};
